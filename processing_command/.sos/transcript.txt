raw_files = ../unified_data_repo_temp2/20180603/YL-0413-17_L1_A003.R1.clean.fastq.gzraw_files = ../unified_data_repo_temp2/20180603/YL-0413-17_L1_A003.R1.clean.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.fastq.gz:
    gunzip -c ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.fastq.gz > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.fastq
    
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.fastq -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.UMI_extract.log -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.umi_encoded.fastq
    
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^ATCAATG -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.umi_encoded.fastq.temp.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.umi_encoded.fastq
    
    ## get the lines/reads number of Read1 that have a Jump Barcode
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.umi_encoded.fastq.temp.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.umi_encoded.fastq.temp.fastq.linenum
    
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.umi_encoded.fastq
    
    
    ## trim reads at the 3'ends to remove sequences from universal adaptors, also remove empty reads
    # -a is the plus strand downstream of the genomic DNA insert (From Read1)
    cutadapt --minimum-length 1 -a CTGTCTCTTATACACATCTAACGGGGTAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.umi_encoded.fastq.temp.fastq 
    
    
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq.linenum
    
    
    
:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.fastq.gz:
    gunzip -c ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.fastq.gz > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.fastq
    
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.fastq -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.UMI_extract.log -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.umi_encoded.fastq
    
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^ATCAATG -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.umi_encoded.fastq.temp.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.umi_encoded.fastq
    
    ## get the lines/reads number of Read1 that have a Jump Barcode
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.umi_encoded.fastq.temp.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.umi_encoded.fastq.temp.fastq.linenum
    
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.umi_encoded.fastq
    
    
    ## trim reads at the 3'ends to remove sequences from universal adaptors, also remove empty reads
    # -a is the plus strand downstream of the genomic DNA insert (From Read1)
    cutadapt --minimum-length 1 -a CTGTCTCTTATACACATCTAACGGGGTAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.umi_encoded.fastq.temp.fastq 
    
    
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq.linenum
    
    
    
:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.fastq.gz:
    gunzip -c ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.fastq.gz > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.fastq
    
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.fastq -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.UMI_extract.log -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.umi_encoded.fastq
    
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^ATCAATG -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.umi_encoded.fastq.temp.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.umi_encoded.fastq
    
    ## get the lines/reads number of Read1 that have a Jump Barcode
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.umi_encoded.fastq.temp.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.umi_encoded.fastq.temp.fastq.linenum
    
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.umi_encoded.fastq
    
    
    ## trim reads at the 3'ends to remove sequences from universal adaptors, also remove empty reads
    # -a is the plus strand downstream of the genomic DNA insert (From Read1)
    cutadapt --minimum-length 1 -a CTGTCTCTTATACACATCTAACGGGGTAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.umi_encoded.fastq.temp.fastq 
    
    
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq.linenum
    
    
    
:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.fastq.gz:
    gunzip -c ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.fastq.gz > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.fastq
    
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.fastq -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.UMI_extract.log -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.umi_encoded.fastq
    
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^ATCAATG -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.umi_encoded.fastq.temp.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.umi_encoded.fastq
    
    ## get the lines/reads number of Read1 that have a Jump Barcode
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.umi_encoded.fastq.temp.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.umi_encoded.fastq.temp.fastq.linenum
    
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.umi_encoded.fastq
    
    
    ## trim reads at the 3'ends to remove sequences from universal adaptors, also remove empty reads
    # -a is the plus strand downstream of the genomic DNA insert (From Read1)
    cutadapt --minimum-length 1 -a CTGTCTCTTATACACATCTAACGGGGTAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.umi_encoded.fastq.temp.fastq 
    
    
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq.linenum
    
    
    
:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.fastq.gz:
    gunzip -c ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.fastq.gz > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.fastq
    
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.fastq -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.UMI_extract.log -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.umi_encoded.fastq
    
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^ATCAATG -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.umi_encoded.fastq.temp.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.umi_encoded.fastq
    
    ## get the lines/reads number of Read1 that have a Jump Barcode
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.umi_encoded.fastq.temp.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.umi_encoded.fastq.temp.fastq.linenum
    
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.umi_encoded.fastq
    
    
    ## trim reads at the 3'ends to remove sequences from universal adaptors, also remove empty reads
    # -a is the plus strand downstream of the genomic DNA insert (From Read1)
    cutadapt --minimum-length 1 -a CTGTCTCTTATACACATCTAACGGGGTAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.umi_encoded.fastq.temp.fastq 
    
    
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq.linenum
    
    
    
:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.fastq.gz:
    gunzip -c ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.fastq.gz > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.fastq
    
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.fastq -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.UMI_extract.log -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.umi_encoded.fastq
    
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^ATCAATG -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.umi_encoded.fastq.temp.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.umi_encoded.fastq
    
    ## get the lines/reads number of Read1 that have a Jump Barcode
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.umi_encoded.fastq.temp.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.umi_encoded.fastq.temp.fastq.linenum
    
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.umi_encoded.fastq
    
    
    ## trim reads at the 3'ends to remove sequences from universal adaptors, also remove empty reads
    # -a is the plus strand downstream of the genomic DNA insert (From Read1)
    cutadapt --minimum-length 1 -a CTGTCTCTTATACACATCTAACGGGGTAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.umi_encoded.fastq.temp.fastq 
    
    
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq.linenum
    
    
    
:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.fastq.gz:
    gunzip -c ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.fastq.gz > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.fastq
    
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.fastq -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.UMI_extract.log -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.umi_encoded.fastq
    
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^ATCAATG -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.umi_encoded.fastq.temp.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.umi_encoded.fastq
    
    ## get the lines/reads number of Read1 that have a Jump Barcode
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.umi_encoded.fastq.temp.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.umi_encoded.fastq.temp.fastq.linenum
    
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.umi_encoded.fastq
    
    
    ## trim reads at the 3'ends to remove sequences from universal adaptors, also remove empty reads
    # -a is the plus strand downstream of the genomic DNA insert (From Read1)
    cutadapt --minimum-length 1 -a CTGTCTCTTATACACATCTAACGGGGTAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.umi_encoded.fastq.temp.fastq 
    
    
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq.linenum
    
    
    
:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.fastq.gz:
    gunzip -c ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.fastq.gz > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.fastq
    
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.fastq -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.UMI_extract.log -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.umi_encoded.fastq
    
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^ATCAATG -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.umi_encoded.fastq.temp.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.umi_encoded.fastq
    
    ## get the lines/reads number of Read1 that have a Jump Barcode
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.umi_encoded.fastq.temp.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.umi_encoded.fastq.temp.fastq.linenum
    
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.umi_encoded.fastq
    
    
    ## trim reads at the 3'ends to remove sequences from universal adaptors, also remove empty reads
    # -a is the plus strand downstream of the genomic DNA insert (From Read1)
    cutadapt --minimum-length 1 -a CTGTCTCTTATACACATCTAACGGGGTAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.umi_encoded.fastq.temp.fastq 
    
    
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq.linenum
    
    
    
:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.fastq.gz:
    gunzip -c ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.fastq.gz > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.fastq
    
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.fastq -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.UMI_extract.log -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.umi_encoded.fastq
    
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^ATCAATG -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.umi_encoded.fastq.temp.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.umi_encoded.fastq
    
    ## get the lines/reads number of Read1 that have a Jump Barcode
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.umi_encoded.fastq.temp.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.umi_encoded.fastq.temp.fastq.linenum
    
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.umi_encoded.fastq
    
    
    ## trim reads at the 3'ends to remove sequences from universal adaptors, also remove empty reads
    # -a is the plus strand downstream of the genomic DNA insert (From Read1)
    cutadapt --minimum-length 1 -a CTGTCTCTTATACACATCTAACGGGGTAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.umi_encoded.fastq.temp.fastq 
    
    
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq.linenum
    
    
    
:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.fastq.gz:
    gunzip -c ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.fastq.gz > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.fastq
    
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.fastq -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.UMI_extract.log -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.umi_encoded.fastq
    
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^ATCAATG -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.umi_encoded.fastq.temp.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.umi_encoded.fastq
    
    ## get the lines/reads number of Read1 that have a Jump Barcode
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.umi_encoded.fastq.temp.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.umi_encoded.fastq.temp.fastq.linenum
    
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.umi_encoded.fastq
    
    
    ## trim reads at the 3'ends to remove sequences from universal adaptors, also remove empty reads
    # -a is the plus strand downstream of the genomic DNA insert (From Read1)
    cutadapt --minimum-length 1 -a CTGTCTCTTATACACATCTAACGGGGTAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.umi_encoded.fastq.temp.fastq 
    
    
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq.linenum
    
    
    
:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.fastq.gz:
    gunzip -c ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.fastq.gz > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.fastq
    
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.fastq -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.UMI_extract.log -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.umi_encoded.fastq
    
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^ATCAATG -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.umi_encoded.fastq.temp.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.umi_encoded.fastq
    
    ## get the lines/reads number of Read1 that have a Jump Barcode
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.umi_encoded.fastq.temp.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.umi_encoded.fastq.temp.fastq.linenum
    
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.umi_encoded.fastq
    
    
    ## trim reads at the 3'ends to remove sequences from universal adaptors, also remove empty reads
    # -a is the plus strand downstream of the genomic DNA insert (From Read1)
    cutadapt --minimum-length 1 -a CTGTCTCTTATACACATCTAACGGGGTAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.umi_encoded.fastq.temp.fastq 
    
    
    wc -l ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq.linenum
    
    
    
:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.fastq.gzraw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.fastq.gz:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/171022_spike_in_reverse_complement ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu10_S10_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.fastq.gz:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/171022_spike_in_reverse_complement ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu11_S11_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.fastq.gz:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/171022_spike_in_reverse_complement ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu1_S1_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.fastq.gz:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/171022_spike_in_reverse_complement ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu2_S2_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.fastq.gz:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/171022_spike_in_reverse_complement ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu3_S3_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.fastq.gz:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/171022_spike_in_reverse_complement ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu4_S4_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.fastq.gz:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/171022_spike_in_reverse_complement ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu5_S5_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.fastq.gz:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/171022_spike_in_reverse_complement ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu6_S6_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.fastq.gz:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/171022_spike_in_reverse_complement ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu7_S7_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.fastq.gz:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/171022_spike_in_reverse_complement ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu8_S8_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.fastq.gz:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/171022_spike_in_reverse_complement ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180606/CHe-LH-11S-lu9_S9_R1_001.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.fastq.gzraw_files = ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.fastq.gzraw_files = ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.fastq.gz:
    gunzip -c ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.fastq.gz > ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.fastq
    
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.fastq -L ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.UMI_extract.log -S ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.umi_encoded.fastq
    
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^ATCAATG -o ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.umi_encoded.fastq.temp.fastq ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.umi_encoded.fastq
    
    ## get the lines/reads number of Read1 that have a Jump Barcode
    wc -l ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.umi_encoded.fastq.temp.fastq > ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.umi_encoded.fastq.temp.fastq.linenum
    
    rm ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.umi_encoded.fastq
    
    
    ## trim reads at the 3'ends to remove sequences from universal adaptors, also remove empty reads
    # -a is the plus strand downstream of the genomic DNA insert (From Read1)
    cutadapt --minimum-length 1 -a CTGTCTCTTATACACATCTAACGGGGTAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -o ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.umi_encoded.fastq.temp.fastq 
    
    
    wc -l ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.umi_encoded_adaptor_removed_empty_removed.fastq > ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.umi_encoded_adaptor_removed_empty_removed.fastq.linenum
    
    
    
:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.mm9.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.mm9.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.fastq.gz:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/171022_spike_in_reverse_complement ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180603_patch/YL-0413-17_L1_A003.R1.clean.171022_spike_in_reverse_complement.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
raw_files = ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.fastq.gz:
    # trim to only keep 75bp
    cutadapt -l 75 -o ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.fastq.gz ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.fastq.gz
    
    gunzip -c ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.fastq.gz > ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.fastq
    
    
    
    
    
raw_files = ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.fastq.gz:
    # trim to only keep 75bp (remove 75bp from 3'end of reads so there are 75bp from 5' that will be left)
    cutadapt -u -75 -o ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.fastq.gz ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.fastq.gz
    
    gunzip -c ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.fastq.gz > ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.fastq
    
    
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.fastq -L ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.UMI_extract.log -S ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.umi_encoded.fastq
    
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^ATCAATG -o ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.umi_encoded.fastq.temp.fastq ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.umi_encoded.fastq
    
    ## get the lines/reads number of Read1 that have a Jump Barcode
    wc -l ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.umi_encoded.fastq.temp.fastq > ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.umi_encoded.fastq.temp.fastq.linenum
    
    rm ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.umi_encoded.fastq
    
    
    ## trim reads at the 3'ends to remove sequences from universal adaptors, also remove empty reads
    # -a is the plus strand downstream of the genomic DNA insert (From Read1)
    cutadapt --minimum-length 1 -a CTGTCTCTTATACACATCTAACGGGGTAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -o ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.umi_encoded.fastq.temp.fastq 
    
    
    wc -l ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.umi_encoded_adaptor_removed_empty_removed.fastq > ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.umi_encoded_adaptor_removed_empty_removed.fastq.linenum
    
    
    
raw_files = ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.fastq.gz:
    bowtie -p 1 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.umi_encoded_adaptor_removed_empty_removed.fastq ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.mm9.umi_encoded_adaptor_removed_no_mismatch.sam -o ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.mm9.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.mm9.umi_encoded_adaptor_removed_no_mismatch.bam ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted
    rm ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.mm9.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.bam \
    -S ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.log
    samtools flagstat ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../unified_data_repo_temp2/20180603/YL-0413-20_L5_A036.R1.clean.trimmed75bp.mm9.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
