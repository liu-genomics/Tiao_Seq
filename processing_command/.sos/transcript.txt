raw_file = ../data/Data/20170120_first/Jump-NC-1.fastq.gzraw_file = ../data/Data/20170120_first/Jump-NC-1.fastq.gz:
    gunzip -c ../data/Data/20170120_first/Jump-NC-1.fastq.gz > ../data/Data/20170120_first/Jump-NC-1.fastq
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 -I ../data/Data/20170120_first/Jump-NC-1.fastq -L ../data/Data/20170120_first/Jump-NC-1.UMI_extract.log -S ../data/Data/20170120_first/Jump-NC-1.umi_encoded.fastq
    ## discard reads without adaptors
    cutadapt --discard-untrimmed -g ^TGACTCG -o ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-NC-1.umi_encoded.fastq
    
    
:
    bowtie -p 6 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/ ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sam
    
    
raw_file = ../data/Data/20170120_first/Jump-NC-1.fastq.gz:
    bowtie -p 6 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/160811_5hmc_spikein ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sam
    
    
:
    samtools view -bS -F 4 ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools sort ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted
    samtools index ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.bam -S ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    >  ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed
    #remove bam files that are not going to be used
    rm ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus
    rm ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus
    rm ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam
    rm ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam
    
    
:
    awk '{print $3}' ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > None ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R None ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp None ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm None ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
raw_file = ../data/Data/20170120_first/Jump-NC-2.fastq.gz:
    gunzip -c ../data/Data/20170120_first/Jump-NC-2.fastq.gz > ../data/Data/20170120_first/Jump-NC-2.fastq
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 -I ../data/Data/20170120_first/Jump-NC-2.fastq -L ../data/Data/20170120_first/Jump-NC-2.UMI_extract.log -S ../data/Data/20170120_first/Jump-NC-2.umi_encoded.fastq
    ## discard reads without adaptors
    cutadapt --discard-untrimmed -g ^TGACTCG -o ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-NC-2.umi_encoded.fastq
    
    
:
    bowtie -p 6 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/160811_5hmc_spikein ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sam
    
    
:
    samtools view -bS -F 4 ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools sort ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted
    samtools index ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.bam -S ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    >  ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed
    #remove bam files that are not going to be used
    rm ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus
    rm ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus
    rm ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam
    rm ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam
    
    
:
    awk '{print $3}' ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
raw_file = ../data/Data/20170120_first/Jump-2hmC-sites.fastq.gz:
    gunzip -c ../data/Data/20170120_first/Jump-2hmC-sites.fastq.gz > ../data/Data/20170120_first/Jump-2hmC-sites.fastq
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 -I ../data/Data/20170120_first/Jump-2hmC-sites.fastq -L ../data/Data/20170120_first/Jump-2hmC-sites.UMI_extract.log -S ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded.fastq
    ## discard reads without adaptors
    cutadapt --discard-untrimmed -g ^TGACTCG -o ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded.fastq
    
    
:
    bowtie -p 6 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/161116_5hmc_2sites_spikein ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sam
    
    
:
    samtools view -bS -F 4 ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools sort ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted
    samtools index ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.bam -S ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
raw_file = ../data/Data/20170120_first/Jump-600pg.fastq.gz:
    gunzip -c ../data/Data/20170120_first/Jump-600pg.fastq.gz > ../data/Data/20170120_first/Jump-600pg.fastq
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../data/Data/20170120_first/Jump-600pg.fastq -L ../data/Data/20170120_first/Jump-600pg.UMI_extract.log -S ../data/Data/20170120_first/Jump-600pg.umi_encoded.fastq
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^TGACTCG -o ../data/Data/20170120_first/Jump-600pg.umi_encoded_adaptor_removed.fastq \
    ../data/Data/20170120_first/Jump-600pg.umi_encoded.fastq
    
    
    
:
    bowtie -p 4 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../data/Data/20170120_first/Jump-600pg.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-600pg.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../data/Data/20170120_first/Jump-600pg.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_first/Jump-600pg.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../data/Data/20170120_first/Jump-600pg.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../data/Data/20170120_first/Jump-600pg.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_first/Jump-600pg.umi_encoded_adaptor_removed_no_mismatch_sorted
    rm ../data/Data/20170120_first/Jump-600pg.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../data/Data/20170120_first/Jump-600pg.umi_encoded_adaptor_removed_no_mismatch_sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_first/Jump-600pg.umi_encoded_adaptor_removed_no_mismatch_sorted.bam \
    -S ../data/Data/20170120_first/Jump-600pg.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam -L ../data/Data/20170120_first/Jump-600pg.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_first/Jump-600pg.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam > ../data/Data/20170120_first/Jump-600pg.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
raw_file = ../data/Data/20170120_first/Jump-positive.fastq.gz:
    gunzip -c ../data/Data/20170120_first/Jump-positive.fastq.gz > ../data/Data/20170120_first/Jump-positive.fastq
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 -I ../data/Data/20170120_first/Jump-positive.fastq -L ../data/Data/20170120_first/Jump-positive.UMI_extract.log -S ../data/Data/20170120_first/Jump-positive.umi_encoded.fastq
    ## discard reads without adaptors
    cutadapt --discard-untrimmed -g ^TGACTCG -o ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-positive.umi_encoded.fastq
    
    
:
    bowtie -p 6 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/160811_5hmc_spikein ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sam
    
    
:
    samtools view -bS -F 4 ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools sort ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted
    samtools index ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.bam -S ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
raw_file = ../data/Data/20170120_first/Jump-NC-2.fastq.gz:
    gunzip -c ../data/Data/20170120_first/Jump-NC-2.fastq.gz > ../data/Data/20170120_first/Jump-NC-2.fastq
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../data/Data/20170120_first/Jump-NC-2.fastq -L ../data/Data/20170120_first/Jump-NC-2.UMI_extract.log -S ../data/Data/20170120_first/Jump-NC-2.umi_encoded.fastq
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^TGACTCG -o ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed.fastq \
    ../data/Data/20170120_first/Jump-NC-2.umi_encoded.fastq
    
    
    
:
    bowtie -p 4 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted
    rm ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted.bam \
    -S ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam -L ../data/Data/20170120_first/Jump-NC-2.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam > ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
raw_file = ../data/Data/20170120_first/Jump-2hmC-sites.fastq.gz:
    gunzip -c ../data/Data/20170120_first/Jump-2hmC-sites.fastq.gz > ../data/Data/20170120_first/Jump-2hmC-sites.fastq
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../data/Data/20170120_first/Jump-2hmC-sites.fastq -L ../data/Data/20170120_first/Jump-2hmC-sites.UMI_extract.log -S ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded.fastq
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^TGACTCG -o ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed.fastq \
    ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded.fastq
    
    
    
:
    bowtie -p 4 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted
    rm ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted.bam \
    -S ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam -L ../data/Data/20170120_first/Jump-2hmC-sites.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam > ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
raw_file = ../data/Data/20170120_first/Jump-positive.fastq.gz:
    gunzip -c ../data/Data/20170120_first/Jump-positive.fastq.gz > ../data/Data/20170120_first/Jump-positive.fastq
    
    
    
raw_file = ../data/Data/20170120_first/Jump-NC-2.fastq.gzprefix = Jump-NC-2cov_input_file = ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    >  ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed
    #remove bam files that are not going to be used
    rm ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus
    rm ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus
    rm ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam
    rm ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam
    
    
:
    awk '{print $3}' ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
raw_file = ../data/Data/20170120_first/Jump-NC-2.fastq.gzprefix = Jump-NC-2cov_input_file = ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam:
    awk '{print $3}' ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
prefix = Jump-NC-2cov_input_file = ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bamraw_file = ../data/Data/20170120_first/Jump-NC-2.fastq.gz:
    awk '{print $3}' ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
prefix = Jump-NC-2cov_input_file = ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bamraw_file = ../data/Data/20170120_first/Jump-NC-2.fastq.gz:
    awk '{print $3}' ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
raw_file = ../data/Data/20170120_first/Jump-NC-2.fastq.gzprefix = Jump-NC-2cov_input_file = ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam:
    awk '{print $3}' ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
raw_file = ../data/Data/20170120_first/Jump-NC-2.fastq.gzprefix = Jump-NC-2cov_input_file = ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam:
    awk '{print $3}' ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
raw_file = ../data/Data/20170120_first/Jump-NC-2.fastq.gzprefix = Jump-NC-2cov_input_file = ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam:
    awk '{print $3}' ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
prefix = Jump-NC-2cov_input_file = ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam:
    awk '{print $3}' ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
prefix = Jump-NC-2cov_input_file = ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam:
    awk '{print $3}' ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed[1] | sort | uniq -c | awk '{print $1"\t"$2}' > None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
prefix = Jump-NC-2cov_input_file = ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam:
    awk '{print $3}' ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm None ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
prefix = Jump-NC-2cov_input_file = ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    >  ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed
    #remove bam files that are not going to be used
    rm ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus
    rm ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus
    rm ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam
    rm ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam
    
    
:
    awk '{print $3}' ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm ../data/Data/20170120_first/Jump-NC-2.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
prefix = Jump-2hmC-sitescov_input_file = ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    >  ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed
    #remove bam files that are not going to be used
    rm ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus
    rm ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus
    rm ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam
    rm ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam
    
    
:
    awk '{print $3}' ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
prefix = Jump-positivecov_input_file = ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    >  ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed
    #remove bam files that are not going to be used
    rm ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus
    rm ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus
    rm ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam
    rm ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam
    
    
:
    awk '{print $3}' ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
prefix = Jump-NC-1cov_input_file = ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    >  ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed
    #remove bam files that are not going to be used
    rm ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus
    rm ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus
    rm ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam
    rm ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam
    
    
:
    awk '{print $3}' ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm ../data/Data/20170120_first/Jump-NC-1.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
prefix = Jump-2hmC-sitesmapping_input_file = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed.fastq:
    bowtie -p 6 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/161116_5hmc_2sites_spikein ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sam
    
    
:
    samtools view -bS -F 4 ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools sort ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted
    samtools index ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.bam -S ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
raw_file = ../data/Data/20170120_first/Jump-NC-1.fastq.gz:
    gunzip -c ../data/Data/20170120_first/Jump-NC-1.fastq.gz > ../data/Data/20170120_first/Jump-NC-1.fastq
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../data/Data/20170120_first/Jump-NC-1.fastq -L ../data/Data/20170120_first/Jump-NC-1.UMI_extract.log -S ../data/Data/20170120_first/Jump-NC-1.umi_encoded.fastq
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^TGACTCG -o ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed.fastq \
    ../data/Data/20170120_first/Jump-NC-1.umi_encoded.fastq
    
    
    
:
    bowtie -p 4 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted
    rm ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted.bam \
    -S ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam -L ../data/Data/20170120_first/Jump-NC-1.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam > ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
prefix = Jump-2hmC-sitesmapping_input_file = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed.fastq:
    samtools view -bS -F 4 ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools sort ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted
    samtools index ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.bam -S ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../data/Data/20170120_first/Jump-2hmC-sites.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
raw_file = ../data/Data/20170120_first/Jump-2hmC-sites.fastq.gz:
    bowtie -p 4 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted
    rm ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted.bam \
    -S ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam -L ../data/Data/20170120_first/Jump-2hmC-sites.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam > ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
raw_file = ../data/Data/20170120_first/Jump-positive.fastq.gz:
    gunzip -c ../data/Data/20170120_first/Jump-positive.fastq.gz > ../data/Data/20170120_first/Jump-positive.fastq
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../data/Data/20170120_first/Jump-positive.fastq -L ../data/Data/20170120_first/Jump-positive.UMI_extract.log -S ../data/Data/20170120_first/Jump-positive.umi_encoded.fastq
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^TGACTCG -o ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed.fastq \
    ../data/Data/20170120_first/Jump-positive.umi_encoded.fastq
    
    
    
:
    bowtie -p 4 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted
    rm ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted.bam \
    -S ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam -L ../data/Data/20170120_first/Jump-positive.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam > ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
bam_file = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix_plus = .plus_sites_with_1_coverage.bedGraphpostfix_minus = .minus_sites_with_1_coverage.bedGraphbam_file = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .minus.sorted.5prime.bedprime5_minus_bed_files = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed
    
    
    
postfix = .plus.sorted.5prime.bedprime5_plus_bed_files = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bedpostfix_plus = .plus_sites_with_1_coverage.bedGraphpostfix_minus = .minus_sites_with_1_coverage.bedGraphbam_file = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .plus.sorted.5prime.bedprime5_plus_bed_files = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bambam_file = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .minus.sorted.5prime.bedprime5_minus_bed_files = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed
    
    
    
bam_file = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .minus.sorted.5prime.bedprime5_minus_bed_files = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .plus.sorted.5prime.bedprime5_plus_bed_files = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix_plus = .plus_sites_with_1_coverage.bedGraphpostfix_minus = .minus_sites_with_1_coverage.bedGraph:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed
    
    
    
postfix_plus = .plus_sites_with_1_coverage.bedGraphpostfix_minus = .minus_sites_with_1_coverage.bedGraphbam_file = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bambam_file = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .plus.sorted.5prime.bedprime5_plus_bed_files = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .minus.sorted.5prime.bedprime5_minus_bed_files = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed
    
    
    
bam_file = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bambam_file = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .minus.sorted.5prime.bedprime5_minus_bed_files = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .plus.sorted.5prime.bedprime5_plus_bed_files = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bedpostfix_plus = .plus_sites_with_1_coverage.bedGraphpostfix_minus = .minus_sites_with_1_coverage.bedGraph:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed
    
    
    
:
    bedtools intersect -wa -a ../data/published_site/GSM882244_mESC.hmC_sites.FDR_0.0484.mm9.txt_minus.extend_100bp_separated.bed -b ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed  | sort | uniq > ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bed
    bedtools coverage -a ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed -b ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bed -d > ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraph
    
    
:
    bedtools intersect -wa -a ../data/published_site/GSM882244_mESC.hmC_sites.FDR_0.0484.mm9.txt_plus.extend_100bp_separated.bed -b ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed | sort | uniq > ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bed
    bedtools coverage -a ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed -b ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bed -d > ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraph
    
    
bam_file = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix_plus = .plus_sites_with_1_coverage.bedGraphpostfix_minus = .minus_sites_with_1_coverage.bedGraphbam_file = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .plus.sorted.5prime.bedprime5_plus_bed_files = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed
    
    
    
bam_file = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .minus.sorted.5prime.bedprime5_minus_bed_files = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed:
    bedtools intersect -wa -a ../data/published_site/GSM882244_mESC.hmC_sites.FDR_0.0484.mm9.txt_minus.extend_100bp_separated.bed -b ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed  | sort | uniq > ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bed
    bedtools coverage -a ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed -b ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bed -d > ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraph
    
    
:
    bedtools intersect -wa -a ../data/published_site/GSM882244_mESC.hmC_sites.FDR_0.0484.mm9.txt_plus.extend_100bp_separated.bed -b ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed | sort | uniq > ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bed
    bedtools coverage -a ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed -b ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bed -d > ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraph
    
    
bam_file = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .plus.sorted.5prime.bedprime5_plus_bed_files = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bambam_file = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .minus.sorted.5prime.bedprime5_minus_bed_files = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed
    
    
    
:
    bedtools intersect -wa -a ../data/published_site/GSM882244_mESC.hmC_sites.FDR_0.0484.mm9.txt_minus.extend_100bp_separated.bed -b ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed  | sort | uniq > ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bed
    bedtools coverage -a ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed -b ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bed -d > ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraph
    
    
postfix_plus = .plus_sites_with_1_coverage.bedGraphpostfix_minus = .minus_sites_with_1_coverage.bedGraph:
    bedtools intersect -wa -a ../data/published_site/GSM882244_mESC.hmC_sites.FDR_0.0484.mm9.txt_plus.extend_100bp_separated.bed -b ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed | sort | uniq > ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bed
    bedtools coverage -a ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed -b ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bed -d > ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraph
    
    
bam_file = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix_plus = .plus_sites_with_1_coverage.bedGraphpostfix_minus = .minus_sites_with_1_coverage.bedGraphbam_file = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .minus.sorted.5prime.bedprime5_minus_bed_files = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .plus.sorted.5prime.bedprime5_plus_bed_files = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed
    
    
    
:
    bedtools intersect -wa -a ../data/published_site/GSM882244_mESC.hmC_sites.FDR_0.0484.mm9.txt_plus.extend_100bp_separated.bed -b ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed | sort | uniq > ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bed
    bedtools coverage -a ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed -b ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bed -d > ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraph
    
    
:
    bedtools intersect -wa -a ../data/published_site/GSM882244_mESC.hmC_sites.FDR_0.0484.mm9.txt_minus.extend_100bp_separated.bed -b ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed  | sort | uniq > ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bed
    bedtools coverage -a ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bed -b ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bed -d > ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraph
    
    
bam_file = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .minus.sorted.5prime.bedprime5_minus_bed_files = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix_plus = .plus_sites_with_1_coverage.bedGraphpostfix_minus = .minus_sites_with_1_coverage.bedGraphbedgraph_files_1 = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraphbedgraph_files_2 = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraphbedgraph_files = ['../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraph', '../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraph']bam_file = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .plus.sorted.5prime.bedprime5_plus_bed_files = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam:
    rm -f ../data/Data/../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.ave.perbase
    for i in {1..201} 
    
    do awk -v i="$i" '$5 == i' ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraph | awk '{print $6}'|paste -s -d+ | bc >> ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.ave.perbase
    done
    
    
:
    rm -f ../data/Data/../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.ave.perbase
    for i in {1..201} 
    
    do awk -v i="$i" '$5 == i' ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraph | awk '{print $6}'|paste -s -d+ | bc >> ../data/Data/20170120_first/Jump-NC-1.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.ave.perbase
    done
    
    
bam_file = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bambam_file = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .minus.sorted.5prime.bedprime5_minus_bed_files = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .plus.sorted.5prime.bedprime5_plus_bed_files = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix_plus = .plus_sites_with_1_coverage.bedGraphpostfix_minus = .minus_sites_with_1_coverage.bedGraphbedgraph_files_1 = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraphbedgraph_files_2 = ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraphbedgraph_files = ['../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraph', '../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraph']:
    rm -f ../data/Data/../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.ave.perbase
    for i in {1..201} 
    
    do awk -v i="$i" '$5 == i' ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraph | awk '{print $6}'|paste -s -d+ | bc >> ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.ave.perbase
    done
    
    
:
    rm -f ../data/Data/../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.ave.perbase
    for i in {1..201} 
    
    do awk -v i="$i" '$5 == i' ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraph | awk '{print $6}'|paste -s -d+ | bc >> ../data/Data/20170120_first/Jump-NC-2.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.ave.perbase
    done
    
    
bam_file = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix_plus = .plus_sites_with_1_coverage.bedGraphpostfix_minus = .minus_sites_with_1_coverage.bedGraphbedgraph_files_1 = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraphbedgraph_files_2 = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraphbedgraph_files = ['../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraph', '../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraph']bam_file = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .plus.sorted.5prime.bedprime5_plus_bed_files = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bambam_file = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .minus.sorted.5prime.bedprime5_minus_bed_files = ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bed:
    rm -f ../data/Data/../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.ave.perbase
    for i in {1..201} 
    
    do awk -v i="$i" '$5 == i' ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraph | awk '{print $6}'|paste -s -d+ | bc >> ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.ave.perbase
    done
    
    
:
    rm -f ../data/Data/../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.ave.perbase
    for i in {1..201} 
    
    do awk -v i="$i" '$5 == i' ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraph | awk '{print $6}'|paste -s -d+ | bc >> ../data/Data/20170120_first/Jump-2hmC-sites.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.ave.perbase
    done
    
    
bam_file = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .plus.sorted.5prime.bedprime5_plus_bed_files = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bambam_file = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix = .minus.sorted.5prime.bedprime5_minus_bed_files = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus.sorted.5prime.bedbam_file = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bampostfix_plus = .plus_sites_with_1_coverage.bedGraphpostfix_minus = .minus_sites_with_1_coverage.bedGraphbedgraph_files_1 = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraphbedgraph_files_2 = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraphbedgraph_files = ['../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraph', '../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraph']:
    rm -f ../data/Data/../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.ave.perbase
    for i in {1..201} 
    
    do awk -v i="$i" '$5 == i' ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.bedGraph | awk '{print $6}'|paste -s -d+ | bc >> ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.plus_sites_with_1_coverage.ave.perbase
    done
    
    
:
    rm -f ../data/Data/../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.ave.perbase
    for i in {1..201} 
    
    do awk -v i="$i" '$5 == i' ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.bedGraph | awk '{print $6}'|paste -s -d+ | bc >> ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam.minus_sites_with_1_coverage.ave.perbase
    done
    
    
prefix = Jump-positivemapping_input_file = ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed.fastq:
    bowtie -p 6 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/160811_5hmc_spikein ../data/Data/20170120_first/Jump-positive.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sam
    
    
:
    samtools view -bS -F 4 ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools sort ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted
    samtools index ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.bam -S ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../data/Data/20170120_first/Jump-positive.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
prefix = Jump-2hmC-sites_5pctcov_input_file = ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    >  ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed
    #remove bam files that are not going to be used
    rm ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus
    rm ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus
    rm ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam
    rm ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam
    
    
:
    awk '{print $3}' ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm ../data/Data/20170120_first/Jump-2hmC-sites_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
prefix = Jump-positive_5pctcov_input_file = ../data/Data/20170120_first/Jump-positive_5pct.161116_5hmc_2sites_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bamprefix = Jump-positive_5pctcov_input_file = ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam:
    samtools view -b -F 20 -o ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools view -b -f 16 -o ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam 
    samtools sort ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted
    samtools sort ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted
    # for plus strand reads, only keep the 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam | awk {'print $1"\t"$2"\t"$2+1"\t"$4"\t"$5"\t"$6'} \
    >  ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.5prime.bed
    # for minus strand reads,only keep 5' position
    bedtools bamtobed -i ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam | awk {'print $1"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6'} \
    > ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed
    #remove bam files that are not going to be used
    rm ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus
    rm ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus
    rm ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.plus.sorted.bam
    rm ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.bam
    
    
:
    awk '{print $3}' ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed | sort | uniq -c | awk '{print $1"\t"$2}' > ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    Rscript ../lib/pipeline_160912_bioinformatics_preprocessing_using_spike_in_andUMI.R ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase 200
    rm ../data/Data/20170120_first/Jump-positive_5pct.160811_5hmc_spikein.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.minus.sorted.5prime.bed.coverage.ave.perbase.tmp
    
    
    
    
raw_file = ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.fastq.gz:
    gunzip -c ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.fastq.gz > ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.fastq
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.fastq -L ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.UMI_extract.log -S ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded.fastq
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^TGACTCG -o ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded_adaptor_removed.fastq \
    ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded.fastq
    
    
    
:
    bowtie -p 4 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded_adaptor_removed.fastq ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded_adaptor_removed_no_mismatch.sam -o ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded_adaptor_removed_no_mismatch.bam ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded_adaptor_removed_no_mismatch_sorted
    rm ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded_adaptor_removed_no_mismatch_sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded_adaptor_removed_no_mismatch_sorted.bam \
    -S ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam -L ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.UMI_dedup_no_mismatch.log
    samtools flagstat ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam > ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
raw_file = ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.fastq.gz:
    gunzip -c ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.fastq.gz > ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.fastq
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.fastq -L ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.UMI_extract.log -S ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded.fastq
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^TGACTCG -o ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded_adaptor_removed.fastq \
    ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded.fastq
    
    
    
:
    bowtie -p 4 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded_adaptor_removed.fastq ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded_adaptor_removed_no_mismatch.sam -o ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded_adaptor_removed_no_mismatch.bam ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded_adaptor_removed_no_mismatch_sorted
    rm ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded_adaptor_removed_no_mismatch_sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded_adaptor_removed_no_mismatch_sorted.bam \
    -S ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam -L ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.UMI_dedup_no_mismatch.log
    samtools flagstat ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam > ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
raw_file = ../raw_data/160402/He-lu-6_S6_L006_R1_001.fastq.gz:
    gunzip -c ../raw_data/160402/He-lu-6_S6_L006_R1_001.fastq.gz > ../raw_data/160402/He-lu-6_S6_L006_R1_001.fastq
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../raw_data/160402/He-lu-6_S6_L006_R1_001.fastq -L ../raw_data/160402/He-lu-6_S6_L006_R1_001.UMI_extract.log -S ../raw_data/160402/He-lu-6_S6_L006_R1_001.umi_encoded.fastq
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^TGACTCG -o ../raw_data/160402/He-lu-6_S6_L006_R1_001.umi_encoded_adaptor_removed.fastq \
    ../raw_data/160402/He-lu-6_S6_L006_R1_001.umi_encoded.fastq
    
    
    
raw_file = ../raw_data/160620/He-Lu-6_5mC-jump-48ng-S6_L004_R1_001.fastq.gzraw_file = ../raw_data/160811/20160811_5mC_Jump_Seq_48ng.fastq.gzraw_file = ../data/Data/20170120_second/323T_hmC_jump_cfDNA.fastq.gz:
    gunzip -c ../data/Data/20170120_second/323T_hmC_jump_cfDNA.fastq.gz > ../data/Data/20170120_second/323T_hmC_jump_cfDNA.fastq
    
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 \
    -I ../data/Data/20170120_second/323T_hmC_jump_cfDNA.fastq -L ../data/Data/20170120_second/323T_hmC_jump_cfDNA.UMI_extract.log -S ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded.fastq
    ## discard reads without Jump-seq adaptors 
    cutadapt --discard-untrimmed -g ^TGACTCG -o ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed.fastq \
    ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded.fastq
    
    
    
:
    bowtie -p 4 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/mm9 ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools view -bS ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed_no_mismatch.bam
    rm ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed_no_mismatch.sam
    samtools sort ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed_no_mismatch_sorted
    rm ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools index ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed_no_mismatch_sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed_no_mismatch_sorted.bam \
    -S ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam -L ../data/Data/20170120_second/323T_hmC_jump_cfDNA.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed_no_mismatch_sorted_dedup.bam > ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
prefix = 323T_hmC_jump_cfDNAmapping_input_file = ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed.fastqraw_file = ../data/Data/20170120_second/323T_hmC_jump_cfDNA.fastq.gz:
    gunzip -c ../data/Data/20170120_second/323T_hmC_jump_cfDNA.fastq.gz > ../data/Data/20170120_second/323T_hmC_jump_cfDNA.fastq
    
    
:
    bowtie -p 6 -S -m 1 -n 0 -l 35 -5 1 ../other_annotations/bowtie1_indexed_genome/hg19 ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_second/323T_hmC_jump_cfDNA.hg19.umi_encoded_adaptor_removed_no_mismatch.sam
    
    
:
    /media/yuwen/F/tools/miniconda3/bin/umi_tools extract -p NNNNNNNN --quality-filter-threshold 20 --quality-encoding phred33 -I ../data/Data/20170120_second/323T_hmC_jump_cfDNA.fastq -L ../data/Data/20170120_second/323T_hmC_jump_cfDNA.UMI_extract.log -S ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded.fastq
    ## discard reads without adaptors
    cutadapt --discard-untrimmed -g ^TGACTCG -o ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded_adaptor_removed.fastq ../data/Data/20170120_second/323T_hmC_jump_cfDNA.umi_encoded.fastq
    
    
:
    samtools view -bS -F 4 ../data/Data/20170120_second/323T_hmC_jump_cfDNA.hg19.umi_encoded_adaptor_removed_no_mismatch.sam -o ../data/Data/20170120_second/323T_hmC_jump_cfDNA.hg19.umi_encoded_adaptor_removed_no_mismatch.bam
    samtools sort ../data/Data/20170120_second/323T_hmC_jump_cfDNA.hg19.umi_encoded_adaptor_removed_no_mismatch.bam ../data/Data/20170120_second/323T_hmC_jump_cfDNA.hg19.umi_encoded_adaptor_removed_no_mismatch.sorted
    samtools index ../data/Data/20170120_second/323T_hmC_jump_cfDNA.hg19.umi_encoded_adaptor_removed_no_mismatch.sorted.bam
    /media/yuwen/F/tools/miniconda3/bin/umi_tools dedup -I ../data/Data/20170120_second/323T_hmC_jump_cfDNA.hg19.umi_encoded_adaptor_removed_no_mismatch.sorted.bam -S ../data/Data/20170120_second/323T_hmC_jump_cfDNA.hg19.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam -L ../data/Data/20170120_second/323T_hmC_jump_cfDNA.hg19.UMI_dedup_no_mismatch.log
    samtools flagstat ../data/Data/20170120_second/323T_hmC_jump_cfDNA.hg19.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam > ../data/Data/20170120_second/323T_hmC_jump_cfDNA.hg19.umi_encoded_adaptor_removed_no_mismatch.sorted.dedup.bam.flagstat
    
    
raw_file = ../unified_data_repo/20170120_second/test.fastq.gz:
    gunzip -c ../unified_data_repo/20170120_second/test.fastq.gz > ../unified_data_repo/20170120_second/test.fastq
    
    
:
    bowtie -p 4 -S -m 1 ../other_annotations/bowtie1_indexed_genome/hg19 ../unified_data_repo/20170120_second/test.fastq ../unified_data_repo/20170120_second/test.hg19_bowtie1.sam
    samtools view -bS -o ../unified_data_repo/20170120_second/test.hg19_bowtie1.bam ../unified_data_repo/20170120_second/test.hg19_bowtie1.sam
    samtools flagstat ../unified_data_repo/20170120_second/test.hg19_bowtie1.bam > ../unified_data_repo/20170120_second/test.hg19_bowtie1.bam.flagstat
    
raw_file = ../unified_data_repo/20170120_second/323A_gDNA_input.fastq.gz:
    gunzip -c ../unified_data_repo/20170120_second/323A_gDNA_input.fastq.gz > ../unified_data_repo/20170120_second/323A_gDNA_input.fastq
    
    
raw_file = ../unified_data_repo/20170120_second/323A_gDNA_input.fastq.gzraw_file = ../unified_data_repo/20170120_second/323A_gDNA_input.fastq.gz:
    gunzip -c ../unified_data_repo/20170120_second/323A_gDNA_input.fastq.gz > ../unified_data_repo/20170120_second/323A_gDNA_input.fastq
    
    
:
    bowtie -p 4 -S -m 1 ../other_annotations/bowtie1_indexed_genome/hg19 ../unified_data_repo/20170120_second/323A_gDNA_input.fastq ../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.sam
    samtools view -bS -o ../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bam ../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.sam
    samtools flagstat ../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bam > ../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bam.flagstat
    
raw_file = ../unified_data_repo/20170120_second/323T_gDNA_input.fastq.gz:
    gunzip -c ../unified_data_repo/20170120_second/323T_gDNA_input.fastq.gz > ../unified_data_repo/20170120_second/323T_gDNA_input.fastq
    
    
:
    bowtie -p 4 -S -m 1 ../other_annotations/bowtie1_indexed_genome/hg19 ../unified_data_repo/20170120_second/323T_gDNA_input.fastq ../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.sam
    samtools view -bS -o ../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bam ../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.sam
    samtools flagstat ../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bam > ../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bam.flagstat
    
raw_file = ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.fastq.gz:
    gunzip -c ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.fastq.gz > ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.fastq
    
    
:
    bowtie -p 4 -S -m 1 ../other_annotations/bowtie1_indexed_genome/hg19 ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.fastq ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.sam
    samtools view -bS -o ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bam ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.sam
    samtools flagstat ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bam > ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bam.flagstat
    
raw_file = ../unified_data_repo/20170120_second/323A_gDNA_seal.fastq.gz:
    gunzip -c ../unified_data_repo/20170120_second/323A_gDNA_seal.fastq.gz > ../unified_data_repo/20170120_second/323A_gDNA_seal.fastq
    
    
:
    bowtie -p 4 -S -m 1 ../other_annotations/bowtie1_indexed_genome/hg19 ../unified_data_repo/20170120_second/323A_gDNA_seal.fastq ../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.sam
    samtools view -bS -o ../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bam ../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.sam
    samtools flagstat ../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bam > ../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bam.flagstat
    
raw_file = ../unified_data_repo/20170120_second/323T_gDNA_seal.fastq.gz:
    gunzip -c ../unified_data_repo/20170120_second/323T_gDNA_seal.fastq.gz > ../unified_data_repo/20170120_second/323T_gDNA_seal.fastq
    
    
:
    bowtie -p 4 -S -m 1 ../other_annotations/bowtie1_indexed_genome/hg19 ../unified_data_repo/20170120_second/323T_gDNA_seal.fastq ../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.sam
    samtools view -bS -o ../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bam ../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.sam
    samtools flagstat ../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bam > ../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bam.flagstat
    
raw_file = ../unified_data_repo/20170120_second/323T_cfDNA_input.fastq.gz:
    gunzip -c ../unified_data_repo/20170120_second/323T_cfDNA_input.fastq.gz > ../unified_data_repo/20170120_second/323T_cfDNA_input.fastq
    
    
:
    bowtie -p 4 -S -m 1 ../other_annotations/bowtie1_indexed_genome/hg19 ../unified_data_repo/20170120_second/323T_cfDNA_input.fastq ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.sam
    samtools view -bS -o ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bam ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.sam
    samtools flagstat ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bam > ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bam.flagstat
    
treatment_file = ../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bamcontrol_file = ../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bamfiles = ['../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bam', '../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bam']output_prefix_abs = ../unified_data_repo/20170120_second/323A_gDNA_seal_vs_323A_gDNA_input:
    macs2 callpeak -t ../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bam -c ../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bam -f bam -g hs -n ../unified_data_repo/20170120_second/323A_gDNA_seal_vs_323A_gDNA_input.keep_dup_all -qvalue 0.05 --keep-dup all
    
    
treatment_file = ../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bamcontrol_file = ../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bamfiles = ['../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bam', '../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bam']output_prefix_abs = ../unified_data_repo/20170120_second/323T_gDNA_seal_vs_323T_gDNA_input:
    macs2 callpeak -t ../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bam -c ../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bam -f bam -g hs -n ../unified_data_repo/20170120_second/323T_gDNA_seal_vs_323T_gDNA_input.keep_dup_all -qvalue 0.05 --keep-dup all
    
    
treatment_file = ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bamcontrol_file = ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bamfiles = ['../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bam', '../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bam']output_prefix_abs = ../unified_data_repo/20170120_second/323T_hmc_seal_cfDNA_vs_323T_cfDNA_input:
    macs2 callpeak -t ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bam -c ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bam -f bam -g hs -n ../unified_data_repo/20170120_second/323T_hmc_seal_cfDNA_vs_323T_cfDNA_input.keep_dup_all -qvalue 0.05 --keep-dup all
    
    
treatment_file = ../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bamcontrol_file = ../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bamfiles = ['../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bam', '../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bam']output_prefix_abs = ../unified_data_repo/20170120_second/323A_gDNA_seal_vs_323A_gDNA_input:
    macs2 callpeak -t ../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bam -c ../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bam -f BAM -g hs -n ../unified_data_repo/20170120_second/323A_gDNA_seal_vs_323A_gDNA_input.keep_dup_all -qvalue 0.05 --keep-dup all
    
    
treatment_file = ../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bamcontrol_file = ../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bamfiles = ['../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bam', '../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bam']output_prefix_abs = ../unified_data_repo/20170120_second/323T_gDNA_seal_vs_323T_gDNA_input:
    macs2 callpeak -t ../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bam -c ../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bam -f BAM -g hs -n ../unified_data_repo/20170120_second/323T_gDNA_seal_vs_323T_gDNA_input.keep_dup_all -qvalue 0.05 --keep-dup all
    
    
treatment_file = ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bamcontrol_file = ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bamfiles = ['../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bam', '../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bam']output_prefix_abs = ../unified_data_repo/20170120_second/323T_hmc_seal_cfDNA_vs_323T_cfDNA_input:
    macs2 callpeak -t ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bam -c ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bam -f BAM -g hs -n ../unified_data_repo/20170120_second/323T_hmc_seal_cfDNA_vs_323T_cfDNA_input.keep_dup_all -qvalue 0.05 --keep-dup all
    
    
treatment_file = ../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bamcontrol_file = ../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bamfiles = ['../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bam', '../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bam']output_prefix_abs = ../unified_data_repo/20170120_second/323A_gDNA_seal_vs_323A_gDNA_input:
    macs2 callpeak -t ../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bam -c ../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bam -f BAM -g hs -n ../unified_data_repo/20170120_second/323A_gDNA_seal_vs_323A_gDNA_input.keep_dup_all --qvalue 0.05 --keep-dup all
    
    
treatment_file = ../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bamcontrol_file = ../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bamfiles = ['../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bam', '../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bam']output_prefix_abs = ../unified_data_repo/20170120_second/323T_gDNA_seal_vs_323T_gDNA_input:
    macs2 callpeak -t ../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bam -c ../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bam -f BAM -g hs -n ../unified_data_repo/20170120_second/323T_gDNA_seal_vs_323T_gDNA_input.keep_dup_all --qvalue 0.05 --keep-dup all
    
    
treatment_file = ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bamcontrol_file = ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bamfiles = ['../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bam', '../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bam']output_prefix_abs = ../unified_data_repo/20170120_second/323T_hmc_seal_cfDNA_vs_323T_cfDNA_input:
    macs2 callpeak -t ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bam -c ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bam -f BAM -g hs -n ../unified_data_repo/20170120_second/323T_hmc_seal_cfDNA_vs_323T_cfDNA_input.keep_dup_all --qvalue 0.05 --keep-dup all
    
    
treatment_file = ../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bamcontrol_file = ../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bamfiles = ['../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bam', '../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bam']output_prefix_abs = ../unified_data_repo/20170120_second/323A_gDNA_seal_vs_323A_gDNA_input:
    macs2 callpeak -t ../unified_data_repo/20170120_second/323A_gDNA_seal.hg19_bowtie1.bam -c ../unified_data_repo/20170120_second/323A_gDNA_input.hg19_bowtie1.bam -f BAM -g hs -n ../unified_data_repo/20170120_second/323A_gDNA_seal_vs_323A_gDNA_input.keep_dup_1 --qvalue 0.05 --keep-dup 1
    
    
treatment_file = ../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bamcontrol_file = ../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bamfiles = ['../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bam', '../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bam']output_prefix_abs = ../unified_data_repo/20170120_second/323T_gDNA_seal_vs_323T_gDNA_input:
    macs2 callpeak -t ../unified_data_repo/20170120_second/323T_gDNA_seal.hg19_bowtie1.bam -c ../unified_data_repo/20170120_second/323T_gDNA_input.hg19_bowtie1.bam -f BAM -g hs -n ../unified_data_repo/20170120_second/323T_gDNA_seal_vs_323T_gDNA_input.keep_dup_1 --qvalue 0.05 --keep-dup 1
    
    
treatment_file = ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bamcontrol_file = ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bamfiles = ['../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bam', '../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bam']output_prefix_abs = ../unified_data_repo/20170120_second/323T_hmc_seal_cfDNA_vs_323T_cfDNA_input:
    macs2 callpeak -t ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bam -c ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bam -f BAM -g hs -n ../unified_data_repo/20170120_second/323T_hmc_seal_cfDNA_vs_323T_cfDNA_input.keep_dup_1 --qvalue 0.05 --keep-dup 1
    
    
treatment_file = ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bamcontrol_file = ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bamfiles = ['../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bam', '../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bam']output_prefix_abs = ../unified_data_repo/20170120_second/323T_hmc_seal_cfDNA_vs_323T_cfDNA_input:
    macs2 callpeak -t ../unified_data_repo/20170120_second/323T_hmC_seal_cfDNA.hg19_bowtie1.bam -c ../unified_data_repo/20170120_second/323T_cfDNA_input.hg19_bowtie1.bam -f BAM -g hs -n ../unified_data_repo/20170120_second/323T_hmc_seal_cfDNA_vs_323T_cfDNA_input.keep_dup_all --qvalue 0.05 --keep-dup all
    
    
